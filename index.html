<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <title>Planificateur de tâches</title>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:500" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">

  <script>
    var dojoConfig = {
      packages: [{
        name: "project",
        location: "http://localhost:8080/js/project"
      }],
      deps: ['project/dojorpc']
    };
  </script>
  <script src="//unpkg.com/vue"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.2/socket.io.js"></script>
  <script data-dojo-config="async: 1" src="//ajax.googleapis.com/ajax/libs/dojo/1.12.1/dojo/dojo.js"></script>
</head>

<body id="body" class="loading">
  <div id="app" @click="close">
    <div id="sub-container">
      <loader></loader>
      <!--<line-chart></line-chart>-->
      <projects></projects>
      <le-menu></le-menu>
      <div id="bottom">
        <component :is="currentView" transition="fade" transition-mode="out-in"></component>
        <modal></modal>
      </div>
    </div>
  </div>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="js/styleselect/customSelect.js"></script>
  <!-- TEMPLATE ZONE -->
  <template id="calendar_tpl">
    <div id="graph">
      {{data.test}}
    </div>
  </template>
  <template id="load_tpl">
    <div id="loader" v-if="this.$root.isLoading">
      <div class="demo">
        <svg class="loader">
          <circle cx="25" cy="25" r="16" fill="transparent" stroke="#ABABAB" stroke-width="5" stroke-linecap="round" stroke-dasharray="385"
            stroke-dashoffset="385"></circle>
        </svg>
      </div>
    </div>
  </template>
  <template id="projects_tpl">
    <transition name="fade">
      <div id="projects-slider">
        <div id="data">
          <div id="scroll_container">
            <div class="project" v-for="project in data.project" :proj-id="project.id" @click="openDev(project.id)">
              <!-- PROJECT COLOR ICI -->{{project.name}}</div>
            <div class="project" @click="addProj">Ajouter un projet</div>
          </div>
        </div>
      </div>
    </transition>
  </template>
  <template id="menu_tpl">
    <nav id='menu'>
      <div class="burger" id="burger" @click="toggleMenu()"><div class="menu-icon">
	<span class="menu-icon__line menu-icon__line-left"></span>
	<span class="menu-icon__line"></span>
	<span class="menu-icon__line menu-icon__line-right"></span>
</div></div>
      <div class="menu-wrap">
      <div class="back fa fa-angle-left" @click.stop="$root.back($root.currentView)"></div>
        <ul class="center">
          <li><a href="./detailedProject" @click.stop.prevent="$root.changeView($root.currentView, './detailedProject')">Développements</a></li>
          <li><a href="./resource" @click.stop.prevent="$root.changeView($root.currentView, './resource')">Ressources</a></li>
          <li><a href="./infos" @click.stop.prevent="$root.changeView($root.currentView, './infos')">Infos Pratiques</a></li>
          <li><a href="./customer" @click.stop.prevent="$root.changeView($root.currentView, './customer')">Clients</a></li>
          <li><a href="#">Ressources</a></li>
        </ul>
        <div id="settings">
          <a href="./settings" @click.stop.prevent="$root.changeView($root.currentView, './settings')">
            <span class="fa fa-gear"></span>
            <span class="text">Paramètres</span>
          </a>
        </div>
      </div>
    </nav>
  </template>
  <template id="resource_tpl">
      <transition name="fade">
    <div class="resources" ref="res">
      <div class="resource" v-for="resource in data.resources" @click.capture="getDetailedResource(resource.id)">
        <span class="color"></span><span class="name">{{resource.firstName}} {{resource.name}}</span>
      </div>
      <detailed-res></detailed-res>
      <div id="add_res" @click.stop="addRes">Ajouter une ressource <i class="fa fa-plus-circle" aria-hidden="true"></i></div>
    </div>
        </transition>

  </template>
  <template id="detailed_resource">
    <div id="detailed_res" v-if="this.data.isOpen">
      <div id="photo">
        <!-- <img :src="data.res.photo" :alt="data.res.firstName + data.res.name"> Photo ici -->
      </div>
      <h4>{{this.fullName}}</h4>
    </div>
  </template>
  <template id="detailed_project">
    <transition name="fade">
      <div id="detailed-project" v-if="data.detailedProject.id">
        <modal-form></modal-form>
        <div class="project-infos">
          <div class="project-top-infos">
            <div class="project_name">
              <div id="color" class="color"></div>
              {{data.detailedProject.name}}
            </div>
            <img id="mood" v-if="data.detailedProject.developersMind==='Moy'" src="images/emoticon-square-smiling-face-with-closed-eyes.svg"
              alt="Humeur moyenne">
            <img id="mood" v-else-if="data.detailedProject.developersMind==='Bon'" src="images/image.svg" alt="Bonne humeur">
            <img id="mood" v-else-if="data.detailedProject.developersMind==='Nul'" src="images/image.svg" alt="Mauvaise humeur">

          </div>
          <div id="add_dev" @click="addDev">Ajouter un développement <i class="fa fa-plus-circle" aria-hidden="true"></i></div>
          <development></development>
          {{data.notification}}</div>
      </div>
    </transition>
  </template>
  <template id="modal_form">
    <transition name="fade">
      <div class="edit_container modal-form" v-if="this.data.isOpen" @click.stop>
        <div class="btn close fa fa-window-close" @click="close"></div>
        <form name="editDev">
          <label>Titre
            <input type="text" v-model="data.dev.name" placeholder="Titre">
          </label>
          <label>Au plus tôt
              <input type="date" v-model="data.dev.earlyStart">
              <input type="date" v-model="data.dev.earlyEnd">
            </label>
          <label>Au plus tard
              <input type="date" v-model="data.dev.lateStart">
              <input type="date" v-model="data.dev.lateEnd">
            </label>
          <label>Prévu
              <input type="date" v-model="data.dev.plannedStart">
              <input type="date" v-model="data.dev.plannedEnd">
            </label>
          <label>Réel
              <input type="date" v-model="data.dev.realStart">
              <input type="date" v-model="data.dev.realEnd">
            </label>
          <label>Priorité
            <select name="priority" v-model="data.dev.priority">
              <option value="PrioTresHaute">Très Haute</option>
              <option value="PrioHaute">Haute</option>
              <option value="PrioNormale">Normale</option>
              <option value="PrioBasse">Basse</option>
              <option value="PrioTresBasse">Très Basse</option>
            </select>
            </label>
          <label>Facultatif
              <input type="radio" v-model="data.dev.optional" value="true">
          </label>
          <label>Obligatoire
            <input type="radio" v-model="data.dev.optional" value="false">
          </label>
          <label>
            développement nécessaire
          </label>
          <label>
            développement parent
          </label>
          <label>Ressources
          </label>
          <label v-for="skill in data.allSkills">
            {{skill}}
              <input type="checkbox" v-model="data.dev.skillTags" :value="skill">
          </label>
          <div id="saveDev" class="btn" @click="submitNewDev(data.dev)">Ajouter</div>
        </form>
      </div>
    </transition>
  </template>
  <template id="development">
    <div id="developments">
      <div @click.stop="orderByAZ">Trier par ordre alphabétique</div>
      <div @click.stop="orderByDate">Trier du plus récent au plus ancien</div>
      <edit-dev></edit-dev>
      <transition-group name="fade">
        <div class="dev" :id="dev.id" v-for="dev in data.developments" :key="dev.id" v-if="dev">
          <div class="align-left">
            <span class="dev_name">{{dev.name}}</span>
          </div>
          <div class="align-right">
            <span class="skill-tag" v-for="skills in dev.skillTags">{{skills.id}}</span>
            <span class="date">Du {{dev.plannedStart}} au {{dev.plannedEnd}}</span>
            <span class="edit fa fa-pencil" @click="openEditModal(dev.id)"></span>
            <span class="delete fa fa-trash" @click.stop="deleteDev(dev.id)"></span>
          </div>
        </div>
      </transition-group>

    </div>
  </template>
  <template id="edit_the_dev">
    <transition name="fade">
      <div class="edit_container modal-form" v-if="data.isOpen" @click.stop>
        <div class="btn close fa fa-window-close" @click="close(data.dev.id)"></div>
        <form name="editDev">
          <label>Titre
            <input type="text" v-model="data.dev.name" placeholder="Titre">
          </label>
          <label>Au plus tôt
              <input type="date" v-model="data.dev.earlyStart">
              <input type="date" v-model="data.dev.earlyEnd">
            </label>
          <label>Au plus tard
              <input type="date" v-model="data.dev.lateStart">
              <input type="date" v-model="data.dev.lateEnd">
            </label>
          <label>Prévu
              <input type="date" v-model="data.dev.plannedStart">
              <input type="date" v-model="data.dev.plannedEnd">
            </label>
          <label>Réel
              <input type="date" v-model="data.dev.realStart">
              <input type="date" v-model="data.dev.realEnd">
            </label>
          <label>Priorité
            <select name="priority" v-model="data.dev.priority">
              <option value="PrioTresHaute">Très Haute</option>
              <option value="PrioHaute">Haute</option>
              <option value="PrioNormale">Normale</option>
              <option value="PrioBasse">Basse</option>
              <option value="PrioTresBasse">Très Basse</option>
            </select>
            </label>
          <label>Facultatif
              <input type="radio" v-model="data.dev.optional" value="true">
          </label>
          <label>Obligatoire
              <input type="radio" v-model="data.dev.optional" value="false">
            </label>
          <label>
              développement nécessaire
            </label>
          <label>
              développement parent
            </label>
          <label>Ressources
          </label>
          <label v-for="skill in data.allSkills">
            {{skill}}
              <input type="checkbox" v-model="data.dev.skillTags" :value="skill">
          </label>
          <div id="saveDev" class="btn">Sauvegarder</div>
      </div>
      </form>
    </transition>
  </template>
  <template id="clients_tpl">
    <div class="clients">
      <div class="client" v-for="client in data.clients">
        <span v-if="client.firstName !== client.name">{{client.firstName}} {{client.name}}</span>
        <span v-else>{{client.name}}</span>
      </div>
      <div id="add_client" @click="$root.openModal(this.data)">Ajouter un client
        <i class="fa fa-plus-circle" aria-hidden="true"></i>
      </div>
    </div>

  </template>
  <template id="modal-tpl">
    <transition name="modal">
  <div class="modal-mask" v-if="this.$root.modalOpen" @click.stop="closeModal">
      <div class="modal-wrapper">
        <div class="modal-container" @click.stop>

          <div class="modal-header">
              default header
          </div>

          <div class="modal-body">
              default body
          </div>

          <div class="modal-footer">
              default footer
          </div>
        </div>
      </div>
    </div>
    </transition>
  </template>
  <script>
    function changeURL(url) {
      history.pushState(null, null, url)
    }
  </script>
</body>

</html>